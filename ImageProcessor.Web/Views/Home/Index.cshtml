@{
    ViewBag.Title = "検索キーワード指定";
}

<h2>@ViewBag.Title</h2>
<div class="row">
    <div class="col-xs-12">
        <h4>加工する画像を検索するキーワードを指定します。</h4>
        <hr />

        <!-- Reference the SignalR library. -->
        <form id="frm-keyword">
            <div class="form-group">
                <input type="text" id="txt-keyword" maxlength="255" class="form-control input-lg" />
            </div>
            <div class="row">
                <div class="col-xs-4 col-xs-offset-4">
                    <input type="submit" id="btn-postkeyword" value="指定" class="btn btn-primary btn-lg btn-block" />
                </div>
            </div>
        </form>
    </div>
</div>

@section scripts
{
    <!--Reference the SignalR library. -->
    <script src="/Scripts/jquery.signalR-2.1.1.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="/signalr/hubs"></script>
    <!--Add script to update the page and send messages.-->
    <script type="text/javascript">
        $(function() {
            var frmKeyword = $('#frm-keyword');
            var $txtKeyword = $('#txt-keyword');
            var $btnPostkeyword = $('#btn-postkeyword');

            frmKeyword.submit(function(event) {
                var keyword = $txtKeyword.val();

                event.preventDefault();

                if (!keyword) {
                    return;
                }

                $btnPostkeyword.prop('disabled', true);
                $.ajax({
                    type: 'POST',
                    url: '/api/keywords/',
                    contentType: "application/json",
                    data: JSON.stringify(keyword)
                }).done(function() {
                    $txtKeyword.val('').focus();
                }).fail(function() {
                    alert('キーワードを送れませんでした。');
                }).always(function() {
                    $btnPostkeyword.prop('disabled', false);
                });
            });
        });
    </script>
}